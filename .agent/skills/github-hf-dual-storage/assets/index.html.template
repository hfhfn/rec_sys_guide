<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <title>üìö ${GITHUB_REPO_NAME}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Outfit:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <style>
      :root {
        --primary: #4f46e5; --primary-hover: #4338ca; --bg-light: #f8fafc; --card-bg: rgba(255, 255, 255, 0.8);
        --text-main: #1e293b; --text-muted: #64748b; --border: #e2e8f0; --folder: #e36209;
        --hf-badge-bg: #fef3c7; --hf-badge-text: #92400e; --highlight: rgba(249, 171, 0, 0.1);
        --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }
      [data-theme="dark"] {
        --primary: #818cf8; --primary-hover: #a5b4fc; --bg-light: #0f172a; --card-bg: rgba(30, 41, 59, 0.7);
        --text-main: #f1f5f9; --text-muted: #94a3b8; --border: #334155; --folder: #fb923c;
        --hf-badge-bg: #451a03; --hf-badge-text: #fbbf24; --highlight: rgba(249, 171, 0, 0.2);
      }
      * { box-sizing: border-box; margin: 0; padding: 0; }
      body {
        font-family: "Inter", -apple-system, sans-serif; background-color: var(--bg-light); color: var(--text-main);
        line-height: 1.6; transition: var(--transition); min-height: 100vh; padding: 40px 20px;
        background-image: radial-gradient(at 0% 0%, rgba(79, 70, 229, 0.05) 0px, transparent 50%), radial-gradient(at 100% 0%, rgba(129, 140, 248, 0.05) 0px, transparent 50%);
      }
      .container {
        max-width: 1100px; margin: 0 auto; background: var(--card-bg); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
        border: 1px solid var(--border); border-radius: 24px; padding: 40px; box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
      }
      header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
      h1 { font-family: "Outfit", sans-serif; font-size: 2.2rem; font-weight: 700; background: linear-gradient(135deg, var(--primary), #ec4899); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
      .icon-btn {
        background: var(--border); border: none; width: 44px; height: 44px; border-radius: 12px; cursor: pointer;
        display: flex; align-items: center; justify-content: center; font-size: 1.2rem; color: var(--text-main); transition: var(--transition); text-decoration: none;
      }
      .icon-btn:hover { background: var(--primary); color: white; transform: scale(1.05); }
      .search-wrapper { position: relative; display: flex; gap: 12px; margin-bottom: 20px; }
      #searchInput { flex: 1; padding: 14px 20px; background: var(--bg-light); border: 2px solid var(--border); border-radius: 16px; color: var(--text-main); outline: none; transition: var(--transition); }
      #searchInput:focus { border-color: var(--primary); }
      .skeleton-tree { border-top: 1px solid var(--border); padding-top: 20px; }
      .skeleton-item { height: 40px; background: linear-gradient(90deg, var(--border) 25%, var(--bg-light) 50%, var(--border) 75%); background-size: 200% 100%; animation: shimmer 1.5s infinite linear; border-radius: 10px; margin-bottom: 10px; }
      @keyframes shimmer { 0% { background-position: -200% 0; } 100% { background-position: 200% 0; } }
      .file-tree { border-top: 1px solid var(--border); padding-top: 20px; }
      .folder-header { padding: 10px; border-radius: 10px; cursor: pointer; display: flex; align-items: center; gap: 10px; font-weight: 600; }
      .folder-header:hover { background: rgba(79, 70, 229, 0.05); }
      .toggle-icon { width: 20px; transition: transform 0.2s; text-align: center; }
      .toggle-icon.open { transform: rotate(90deg); }
      .folder-children { margin-left: 28px; border-left: 1.5px solid var(--border); padding-left: 8px; }
      .folder-children.collapsed { display: none; }
      .file-item { padding: 8px 12px; border-radius: 8px; transition: var(--transition); display: flex; align-items: center; justify-content: space-between; }
      .file-item:hover { background: rgba(79, 70, 229, 0.08); transform: translateX(4px); }
      .file-link { text-decoration: none; color: var(--text-main); display: flex; align-items: center; gap: 10px; flex: 1; }
      .hf-badge { background: var(--hf-badge-bg); color: var(--hf-badge-text); padding: 2px 8px; border-radius: 6px; font-size: 0.7rem; font-weight: 700; }
      .gh-badge { background: #e0e7ff; color: #3730a3; padding: 2px 8px; border-radius: 6px; font-size: 0.7rem; font-weight: 700; }
    </style>
  </head>
  <body data-theme="light">
    <div class="container text-main">
      <header>
        <h1>${GITHUB_REPO_NAME}</h1>
        <div class="header-actions">
            <a href="https://github.com/${GITHUB_USERNAME}/${GITHUB_REPO_NAME}" target="_blank" class="icon-btn">
                <svg height="22" width="22" viewBox="0 0 16 16"><path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg>
            </a>
            <a href="https://huggingface.co/datasets/${GITHUB_USERNAME}/${GITHUB_REPO_NAME}" target="_blank" class="icon-btn" title="Êü•Áúã HuggingFace Êï∞ÊçÆÈõÜ" style="font-size: 1.3rem">ü§ó</a>
            <button class="icon-btn" id="themeToggle">üåì</button>
        </div>
      </header>
      <div class="search-wrapper">
        <input type="text" id="searchInput" placeholder="üîç Search resources..." autocomplete="off" />
      </div>
      <main id="file-list" class="file-tree">
        <div class="skeleton-tree">
          <div class="skeleton-item" style="width: 40%"></div>
          <div class="skeleton-item"></div>
          <div class="skeleton-item" style="width: 80%"></div>
        </div>
      </main>
    </div>
    <script>
      const username = "${GITHUB_USERNAME}"; const repo = "${GITHUB_REPO_NAME}";
      const previewExts = ["pdf", "jpg", "jpeg", "png", "gif", "svg", "webp", "txt", "json", "html", "htm"];
      let allFiles = []; let currentSearch = "";

      async function loadData() {
        try {
          const res = await fetch(`./data/file_manifest.json?t=${Date.now()}`);
          if (!res.ok) throw new Error("Manifest failed");
          const data = await res.json(); allFiles = data.files || []; render();
        } catch (e) { document.getElementById("file-list").innerHTML = "Error loading files."; }
      }

      function render() {
        const query = currentSearch.toLowerCase();
        const filtered = allFiles.filter(f => f.name.toLowerCase().includes(query) || f.path.toLowerCase().includes(query));
        const tree = buildTree(filtered);
        document.getElementById("file-list").innerHTML = renderNode(tree);
      }

      function buildTree(files) {
        const root = { _files: [], _folders: {} };
        files.forEach(f => {
          const parts = f.path.split("/"); parts.pop();
          let current = root;
          parts.forEach(p => { if (!current._folders[p]) current._folders[p] = { _files: [], _folders: {} }; current = current._folders[p]; });
          current._files.push(f);
        });
        return root;
      }

      function renderNode(node) {
        let html = "";
        Object.entries(node._folders).sort().forEach(([name, sub]) => {
          html += `<div class="folder"><div class="folder-header" onclick="this.nextElementSibling.classList.toggle('collapsed'); this.querySelector('.toggle-icon').classList.toggle('open')"><span class="toggle-icon ${currentSearch ? 'open' : ''}">‚ñ∂</span>üìÅ ${name}</div><div class="folder-children ${currentSearch ? '' : 'collapsed'}">${renderNode(sub)}</div></div>`;
        });
        node._files.sort((a,b) => a.name.localeCompare(b.name)).forEach(f => {
          const ext = f.name.split(".").pop().toLowerCase();
          let url = f.url;
          if (!f.is_hf) {
            url = previewExts.includes(ext) ? `./${f.path}` : `https://github.com/${username}/${repo}/blob/main/${f.path}`;
          }
          html += `<div class="file-item"><a href="${url}" target="_blank" class="file-link">üìÑ ${f.name} ${f.is_hf ? '<span class="hf-badge">ü§ó HF</span>' : '<span class="gh-badge">üì¶ Git</span>'}</a></div>`;
        });
        return html;
      }

      document.getElementById("searchInput").oninput = (e) => { currentSearch = e.target.value; render(); };
      document.getElementById("themeToggle").onclick = () => {
        const t = document.body.getAttribute("data-theme") === "dark" ? "light" : "dark";
        document.body.setAttribute("data-theme", t);
      };
      loadData();
    </script>
  </body>
</html>
