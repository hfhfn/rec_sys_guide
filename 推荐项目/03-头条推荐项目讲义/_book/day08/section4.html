<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>黑马排序模型进阶-FTRL on Tensorflow | 黑马头条推荐系统项目课程定位、目标</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.6.7">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-katex/katex.min.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-expandable-chapters-small/expandable-chapters-small.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    

        
    
    
    <link rel="next" href="../day08/section5.html" />
    
    
    <link rel="prev" href="../day08/section3.html" />
    

        
    </head>
    <body>
        
        
    <div class="book"
        data-level="9.4"
        data-chapter-title="黑马排序模型进阶-FTRL on Tensorflow"
        data-filepath="day08/section4.md"
        data-basepath=".."
        data-revision="Wed Jul 10 2019 17:55:02 GMT+0800 (CST)"
        data-innerlanguage="">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        黑马头条推荐系统项目
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="reco/index.html">
            
                
                    <a href="../reco/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        黑马头条推荐架构介绍
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="reco/section1.html">
            
                
                    <a href="../reco/section1.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        头条推荐架构
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="reco/section2.html">
            
                
                    <a href="../reco/section2.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        开发环境介绍
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="day01/index.html">
            
                
                    <a href="../day01/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        离线计算更新文章画像
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="day01/section0.html">
            
                
                    <a href="../day01/section0.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        数据库迁移
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="day01/section1.html">
            
                
                    <a href="../day01/section1.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        用户行为收集到HIVE
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="day01/section2.html">
            
                
                    <a href="../day01/section2.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                        离线画像业务介绍
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="day01/section3.html">
            
                
                    <a href="../day01/section3.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.4.</b>
                        
                        离线文章画像计算
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="day01/section4.html">
            
                
                    <a href="../day01/section4.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.</b>
                        
                        离线增量画像更新代码
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="day01/section5.html">
            
                
                    <a href="../day01/section5.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.6.</b>
                        
                        Apscheduler定时更新文章画像
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="day01/section6.html">
            
                
                    <a href="../day01/section6.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.7.</b>
                        
                        Word2Vec与文章相似度
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.8" data-path="day01/section7.html">
            
                
                    <a href="../day01/section7.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.8.</b>
                        
                        文章相似度增量更新
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.9" data-path="day01/section8.html">
            
                
                    <a href="../day01/section8.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.9.</b>
                        
                        总结
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.10" data-path="day01/section9.html">
            
                
                    <a href="../day01/section9.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.10.</b>
                        
                        每日作业
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="day02/index.html">
            
                
                    <a href="../day02/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        离线用户画像更新与召回排序计算
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="day02/section1.html">
            
                
                    <a href="../day02/section1.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        用户画像逻辑
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="day02/section2.html">
            
                
                    <a href="../day02/section2.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        用户画像增量更新
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="day02/section3.html">
            
                
                    <a href="../day02/section3.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                        离线召回与排序介绍
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="day02/section4.html">
            
                
                    <a href="../day02/section4.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.</b>
                        
                        离线用户基于模型召回集
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="day02/section5.html">
            
                
                    <a href="../day02/section5.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.</b>
                        
                        离线用户基于内容召回集
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="day02/section6.html">
            
                
                    <a href="../day02/section6.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.</b>
                        
                        离线用户召回定时更新
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.7" data-path="day02/section7.html">
            
                
                    <a href="../day02/section7.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.7.</b>
                        
                        总结
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.8" data-path="day02/section8.html">
            
                
                    <a href="../day02/section8.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.8.</b>
                        
                        每日作业
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="day03/index.html">
            
                
                    <a href="../day03/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        实时计算业务
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="day03/section1.html">
            
                
                    <a href="../day03/section1.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        实时计算介绍
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="day03/section2.html">
            
                
                    <a href="../day03/section2.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                        Flume
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="day03/section3.html">
            
                
                    <a href="../day03/section3.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.3.</b>
                        
                        Kafka
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="day03/section4.html">
            
                
                    <a href="../day03/section4.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.4.</b>
                        
                        实时日志分析
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="day03/section5.html">
            
                
                    <a href="../day03/section5.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.5.</b>
                        
                        实时召回集业务
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.6" data-path="day03/section6.html">
            
                
                    <a href="../day03/section6.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.6.</b>
                        
                        热门与新文章召回
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.7" data-path="day03/section7.html">
            
                
                    <a href="../day03/section7.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.7.</b>
                        
                        Spark性能优化
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.8" data-path="day03/section8.html">
            
                
                    <a href="../day03/section8.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.8.</b>
                        
                        总结
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.9" data-path="day03/section9.html">
            
                
                    <a href="../day03/section9.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.9.</b>
                        
                        每日作业
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" data-path="day04/index.html">
            
                
                    <a href="../day04/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        推荐业务流实现与ABTest
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1" data-path="day04/section0.html">
            
                
                    <a href="../day04/section0.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                        实时推荐业务介绍
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="day04/section1.html">
            
                
                    <a href="../day04/section1.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.</b>
                        
                        grpc接口对接
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="day04/section2.html">
            
                
                    <a href="../day04/section2.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.3.</b>
                        
                        ABTest实验中心
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.4" data-path="day04/section3.html">
            
                
                    <a href="../day04/section3.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.4.</b>
                        
                        推荐中心逻辑
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.5" data-path="day04/section4.html">
            
                
                    <a href="../day04/section4.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.5.</b>
                        
                        召回集读取服务
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.6" data-path="day04/section5.html">
            
                
                    <a href="../day04/section5.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.6.</b>
                        
                        推荐缓存服务
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.7" data-path="day04/section6.html">
            
                
                    <a href="../day04/section6.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.7.</b>
                        
                        离线排序模型训练基础
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.8" data-path="day04/section7.html">
            
                
                    <a href="../day04/section7.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.8.</b>
                        
                        离线ctr特征中心更新
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.9" data-path="day04/section8.html">
            
                
                    <a href="../day04/section8.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.9.</b>
                        
                        排序模型在线预测
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.10" data-path="day04/section9.html">
            
                
                    <a href="../day04/section9.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.10.</b>
                        
                        总结
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.11" data-path="day04/section10.html">
            
                
                    <a href="../day04/section10.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.11.</b>
                        
                        每日作业
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6" data-path="day05/index.html">
            
                
                    <a href="../day05/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        深度学习与推荐系统
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1" data-path="day05/section1.html">
            
                
                    <a href="../day05/section1.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.1.</b>
                        
                        推荐系统的深度学习关联
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="day05/section2.html">
            
                
                    <a href="../day05/section2.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.2.</b>
                        
                        深度学习应用简介
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7" data-path="day06/index.html">
            
                
                    <a href="../day06/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                        TensorFlow框架介绍
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1" data-path="day06/section1.html">
            
                
                    <a href="../day06/section1.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.</b>
                        
                        TF数据流图
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.2" data-path="day06/section2.html">
            
                
                    <a href="../day06/section2.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.2.</b>
                        
                        图与TensorBoard
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.3" data-path="day06/section3.html">
            
                
                    <a href="../day06/section3.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.3.</b>
                        
                        会话、张量、变量OP
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.4" data-path="day06/section4.html">
            
                
                    <a href="../day06/section4.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.4.</b>
                        
                        案例：TensorFlow实现线性回归
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.5" data-path="day06/section5.html">
            
                
                    <a href="../day06/section5.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.5.</b>
                        
                        TFAPI使用2.0建议
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.6" data-path="day06/section6.html">
            
                
                    <a href="../day06/section6.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.6.</b>
                        
                        tf.estimator入门
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.7" data-path="day06/section7.html">
            
                
                    <a href="../day06/section7.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.7.</b>
                        
                        总结
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.8" data-path="day06/section8.html">
            
                
                    <a href="../day06/section8.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.8.</b>
                        
                        每日作业
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="8" data-path="day07/index.html">
            
                
                    <a href="../day07/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                        神经网络(NN)
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.1" data-path="day07/section1.html">
            
                
                    <a href="../day07/section1.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.1.</b>
                        
                        神经网络基础
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.2" data-path="day07/section2.html">
            
                
                    <a href="../day07/section2.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.</b>
                        
                        神经网络原理
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.3" data-path="day07/section3.html">
            
                
                    <a href="../day07/section3.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.3.</b>
                        
                        案例：神经网络分类
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.4" data-path="day07/section4.html">
            
                
                    <a href="../day07/section4.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.4.</b>
                        
                        word2vec原理
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.5" data-path="day07/section5.html">
            
                
                    <a href="../day07/section5.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.</b>
                        
                        案例：DNN文本多分类
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.6" data-path="day07/section6.html">
            
                
                    <a href="../day07/section6.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.6.</b>
                        
                        总结
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.7" data-path="day07/section7.html">
            
                
                    <a href="../day07/section7.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.7.</b>
                        
                        每日作业
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9" data-path="day08/index.html">
            
                
                    <a href="../day08/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.</b>
                        
                        黑马头条排序模型进阶
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1" data-path="day08/section1.html">
            
                
                    <a href="../day08/section1.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.1.</b>
                        
                        TFRecords与黑马训练数据存储
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.2" data-path="day08/section2.html">
            
                
                    <a href="../day08/section2.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.2.</b>
                        
                        传统CTR排序模型
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.3" data-path="day08/section3.html">
            
                
                    <a href="../day08/section3.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.3.</b>
                        
                        分桶与特征交叉
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="9.4" data-path="day08/section4.html">
            
                
                    <a href="../day08/section4.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.4.</b>
                        
                        黑马排序模型进阶-FTRL on Tensorflow
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.5" data-path="day08/section5.html">
            
                
                    <a href="../day08/section5.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.5.</b>
                        
                        深度学习CTR排序模型
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.6" data-path="day08/section6.html">
            
                
                    <a href="../day08/section6.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.6.</b>
                        
                        黑马排序模型进阶-Wide&amp;Deep
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.7" data-path="day08/section7.html">
            
                
                    <a href="../day08/section7.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.7.</b>
                        
                        WDL模型导出
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.8" data-path="day08/section8.html">
            
                
                    <a href="../day08/section8.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.8.</b>
                        
                        TensorFlow Serving模型部署
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.9" data-path="day08/section9.html">
            
                
                    <a href="../day08/section9.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.9.</b>
                        
                        排序模型在线测试
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.10" data-path="day08/section10.html">
            
                
                    <a href="../day08/section10.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.10.</b>
                        
                        总结
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.11" data-path="day08/section11.html">
            
                
                    <a href="../day08/section11.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.11.</b>
                        
                        每日作业
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >黑马头条推荐系统项目课程定位、目标</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="58-&#x6392;&#x5E8F;&#x6A21;&#x578B;&#x8FDB;&#x9636;fmftrl">5.8 &#x6392;&#x5E8F;&#x6A21;&#x578B;&#x8FDB;&#x9636;-FM&amp;FTRL</h1>
<h2 id="&#x5B66;&#x4E60;&#x76EE;&#x6807;">&#x5B66;&#x4E60;&#x76EE;&#x6807;</h2>
<ul>
<li>&#x76EE;&#x6807;<ul>
<li>&#x65E0;</li>
</ul>
</li>
<li>&#x5E94;&#x7528;<ul>
<li>&#x65E0;</li>
</ul>
</li>
</ul>
<h3 id="581-&#x95EE;&#x9898;">5.8.1 &#x95EE;&#x9898;</h3>
<p>&#x5728;&#x5B9E;&#x9645;&#x9879;&#x76EE;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x7ECF;&#x5E38;&#x4F1A;&#x9047;&#x5230;&#x8BAD;&#x7EC3;&#x6570;&#x636E;&#x975E;&#x5E38;&#x5927;&#x5BFC;&#x81F4;&#x4E00;&#x4E9B;&#x7B97;&#x6CD5;&#x5B9E;&#x9645;&#x4E0A;&#x4E0D;&#x80FD;&#x64CD;&#x4F5C;&#x7684;&#x95EE;&#x9898;&#x3002;&#x6BD4;&#x5982;&#x5728;&#x63A8;&#x8350;&#x884C;&#x4E1A;&#x4E2D;&#xFF0C;&#x56E0;&#x4E3A;&#x8BF7;&#x6C42;&#x6570;&#x636E;&#x91CF;&#x7279;&#x522B;&#x5927;&#xFF0C;&#x4E00;&#x4E2A;&#x661F;&#x671F;&#x7684;&#x6570;&#x636E;&#x5F80;&#x5F80;&#x6709;&#x4E0A;&#x767E;G&#xFF0C;&#x8FD9;&#x79CD;&#x7EA7;&#x522B;&#x7684;&#x6570;&#x636E;&#x5728;&#x8BAD;&#x7EC3;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x76F4;&#x63A5;&#x5957;&#x7528;&#x4E00;&#x4E9B;&#x7B97;&#x6CD5;&#x6846;&#x67B6;&#x662F;&#x6CA1;&#x529E;&#x6CD5;&#x8BAD;&#x7EC3;&#x7684;&#xFF0C;&#x57FA;&#x672C;&#x4E0A;&#x5728;&#x7279;&#x5F81;&#x5DE5;&#x7A0B;&#x7684;&#x9636;&#x6BB5;&#x5C31;&#x4E00;&#x7B79;&#x83AB;&#x5C55;&#x3002;</p>
<h3 id="582-fm&#x7684;&#x9690;&#x5411;&#x91CF;">5.8.2 FM&#x7684;&#x9690;&#x5411;&#x91CF;</h3>
<p>FM&#x548C;FFM&#x6A21;&#x578B;&#x662F;&#x6700;&#x8FD1;&#x51E0;&#x5E74;&#x63D0;&#x51FA;&#x7684;&#x6A21;&#x578B;&#xFF0C;&#x51ED;&#x501F;&#x5176;&#x5728;&#x6570;&#x636E;&#x91CF;&#x6BD4;&#x8F83;&#x6253;&#x5E76;&#x4E14;&#x7279;&#x5F81;&#x7A00;&#x758F;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5FCD;&#x8BA9;&#x80FD;&#x591F;&#x5F97;&#x5230;&#x4F18;&#x79C0;&#x7684;&#x6027;&#x80FD;&#x548C;&#x6548;&#x679C;&#xFF0C;&#x5C61;&#x6B21;&#x5728;&#x5404;&#x5927;&#x516C;&#x53F8;&#x4E3E;&#x529E;&#x7684;CTR&#x9884;&#x4F30;&#x6BD4;&#x8D5B;&#x4E2D;&#x83B7;&#x5F97;&#x4E0D;&#x9519;&#x7684;&#x6218;&#x7EE9;&#x3002;&#x6211;&#x4EEC;&#x56DE;&#x5230;&#x4E4B;&#x524D;&#x6240;&#x8BF4;&#x7684;&#x7279;&#x5F81;&#x4EA4;&#x53C9;&#xFF0C;&#x4E0B;&#x9762;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x3002;</p>
<h4 id="5821-fm&#x7684;&#x539F;&#x7406;&#x53CA;&#x63A8;&#x5BFC;">5.8.2.1 FM&#x7684;&#x539F;&#x7406;&#x53CA;&#x63A8;&#x5BFC;</h4>
<p>&#x56E0;&#x5B50;&#x5206;&#x89E3;&#x673A;&#xFF08;Factorization Machine&#xFF0C;&#x7B80;&#x79F0;FM&#xFF09;&#xFF0C;&#x53C8;&#x79F0;&#x5206;&#x89E3;&#x673A;&#x3002;&#x662F;&#x7531;&#x5FB7;&#x56FD;&#x5EB7;&#x65AF;&#x5766;&#x8328;&#x5927;&#x5B66;&#x7684;Steffen Rendle&#xFF08;&#x73B0;&#x4EFB;&#x804C;&#x4E8E;Google&#xFF09;&#x4E8E;2010&#x5E74;&#x6700;&#x65E9;&#x63D0;&#x51FA;&#x7684;&#xFF0C;&#x65E8;&#x5728;&#x89E3;&#x51B3;&#x5927;&#x89C4;&#x6A21;&#x7A00;&#x758F;&#x6570;&#x636E;&#x4E0B;&#x7684;&#x7279;&#x5F81;&#x7EC4;&#x5408;&#x95EE;&#x9898;&#x3002;&#x5728;&#x7CFB;&#x7EDF;&#x4ECB;&#x7ECD;FM&#x4E4B;&#x524D;&#xFF0C;&#x5148;&#x4E86;&#x89E3;&#x4E00;&#x4E0B;&#x5728;&#x5B9E;&#x9645;&#x573A;&#x666F;&#x4E2D;&#xFF0C;&#x7A00;&#x758F;&#x6570;&#x636E;&#x662F;&#x600E;&#x6837;&#x4EA7;&#x751F;&#x7684;&#x3002;</p>
<p>&#x5047;&#x8BBE;&#x4E00;&#x4E2A;&#x5E7F;&#x544A;&#x5206;&#x7C7B;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x6839;&#x636E;&#x7528;&#x6237;&#x548C;&#x5E7F;&#x544A;&#x4F4D;&#x76F8;&#x5173;&#x7684;&#x7279;&#x5F81;&#xFF0C;&#x9884;&#x6D4B;&#x7528;&#x6237;&#x662F;&#x5426;&#x70B9;&#x51FB;&#x4E86;&#x5E7F;&#x544A;&#x3002;&#x5143;&#x6570;&#x636E;&#x5982;&#x4E0B;&#xFF1A;</p>
<table>
<thead>
<tr>
<th style="text-align:left">Clicked?</th>
<th style="text-align:left">Country</th>
<th style="text-align:left">Day</th>
<th style="text-align:left">Ad_type</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:left">USA</td>
<td style="text-align:left">26/11/15</td>
<td style="text-align:left">Movie</td>
</tr>
<tr>
<td style="text-align:left">0</td>
<td style="text-align:left">China</td>
<td style="text-align:left">1/7/14</td>
<td style="text-align:left">Game</td>
</tr>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:left">China</td>
<td style="text-align:left">19/2/15</td>
<td style="text-align:left">Game</td>
</tr>
</tbody>
</table>
<p>&#x201C;Clicked&#xFF1F;&#x201D;&#x662F;label&#xFF0C;Country&#x3001;Day&#x3001;Ad_type&#x662F;&#x7279;&#x5F81;&#x3002;&#x7531;&#x4E8E;&#x4E09;&#x79CD;&#x7279;&#x5F81;&#x90FD;&#x662F;categorical&#x7C7B;&#x578B;&#x7684;&#xFF0C;&#x9700;&#x8981;&#x7ECF;&#x8FC7;&#x72EC;&#x70ED;&#x7F16;&#x7801;&#xFF08;One-Hot Encoding&#xFF09;&#x8F6C;&#x6362;&#x6210;&#x6570;&#x503C;&#x578B;&#x7279;&#x5F81;&#x3002;</p>
<table>
<thead>
<tr>
<th style="text-align:left">Clicked?</th>
<th style="text-align:left">Country=USA</th>
<th style="text-align:left">Country=China</th>
<th style="text-align:left">Day=26/11/15</th>
<th style="text-align:left">Day=1/7/14</th>
<th style="text-align:left">Day=19/2/15</th>
<th style="text-align:left">Ad_type=Movie</th>
<th style="text-align:left">Ad_type=Game</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
<td style="text-align:left">0</td>
<td style="text-align:left">1</td>
<td style="text-align:left">0</td>
<td style="text-align:left">0</td>
<td style="text-align:left">1</td>
<td style="text-align:left">0</td>
</tr>
<tr>
<td style="text-align:left">0</td>
<td style="text-align:left">0</td>
<td style="text-align:left">1</td>
<td style="text-align:left">0</td>
<td style="text-align:left">1</td>
<td style="text-align:left">0</td>
<td style="text-align:left">0</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:left">0</td>
<td style="text-align:left">1</td>
<td style="text-align:left">0</td>
<td style="text-align:left">0</td>
<td style="text-align:left">1</td>
<td style="text-align:left">0</td>
<td style="text-align:left">1</td>
</tr>
</tbody>
</table>
<p>&#x7531;&#x4E0A;&#x8868;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;&#x7ECF;&#x8FC7;One-Hot&#x7F16;&#x7801;&#x4E4B;&#x540E;&#xFF0C;&#x5927;&#x90E8;&#x5206;&#x6837;&#x672C;&#x6570;&#x636E;&#x7279;&#x5F81;&#x662F;&#x6BD4;&#x8F83;&#x7A00;&#x758F;&#x7684;&#x3002;&#x4E0A;&#x9762;&#x7684;&#x6837;&#x4F8B;&#x4E2D;&#xFF0C;&#x6BCF;&#x4E2A;&#x6837;&#x672C;&#x6709;7&#x7EF4;&#x7279;&#x5F81;&#xFF0C;&#x4F46;&#x5E73;&#x5747;&#x4EC5;&#x6709;3&#x7EF4;&#x7279;&#x5F81;&#x5177;&#x6709;&#x975E;&#x96F6;&#x503C;&#x3002;&#x5B9E;&#x9645;&#x4E0A;&#xFF0C;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x5E76;&#x4E0D;&#x662F;&#x6B64;&#x4F8B;&#x72EC;&#x6709;&#x7684;&#xFF0C;&#x5728;&#x771F;&#x5B9E;&#x5E94;&#x7528;&#x573A;&#x666F;&#x4E2D;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x666E;&#x904D;&#x5B58;&#x5728;&#x3002;&#x4F8B;&#x5982;&#xFF0C;CTR/CVR&#x9884;&#x6D4B;&#x65F6;&#xFF0C;&#x7528;&#x6237;&#x7684;&#x6027;&#x522B;&#x3001;&#x804C;&#x4E1A;&#x3001;&#x6559;&#x80B2;&#x6C34;&#x5E73;&#x3001;&#x54C1;&#x7C7B;&#x504F;&#x597D;&#x3001;&#x5546;&#x54C1;&#x7684;&#x54C1;&#x7C7B;&#x7B49;&#xFF0C;&#x7ECF;&#x8FC7;One-Hot&#x7F16;&#x7801;&#x8F6C;&#x6362;&#x540E;&#x90FD;&#x4F1A;&#x5BFC;&#x81F4;&#x6837;&#x672C;&#x6570;&#x636E;&#x7684;&#x7A00;&#x758F;&#x6027;&#x3002;</p>
<ul>
<li><strong>&#x6570;&#x636E;&#x7A00;&#x758F;&#x6027;&#x662F;&#x5B9E;&#x9645;&#x95EE;&#x9898;&#x4E2D;&#x4E0D;&#x53EF;&#x907F;&#x514D;&#x7684;&#x6311;&#x6218;&#x3002;</strong></li>
</ul>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><mi>y</mi></mrow><mo>^</mo></mover><mo>=</mo><msub><mi>w</mi><mn>0</mn></msub><mo>+</mo><msubsup><mo>&#x2211;</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mrow><msub><mi>w</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub></mrow><mo>+</mo><msubsup><mo>&#x2211;</mo><mi>i</mi><mi>n</mi></msubsup><mrow><msubsup><mo>&#x2211;</mo><mrow><mi>j</mi><mo>=</mo><mi>i</mi><mo>+</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mrow><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>x</mi><mi>i</mi></msub><msub><mi>x</mi><mi>j</mi></msub></mrow></mrow></mrow><annotation encoding="application/x-tex">\hat{y}=w_0+\sum_{i=1}^n{w_ix_i}+\sum_i^n{\sum_{j=i+1}^n{w_{ij}x_ix_j}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.186118em;vertical-align:-0.436118em;"></span><span class="base textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord textstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">y</span></span></span><span style="top:0em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mop"><span class="mop op-symbol small-op" style="top:-0.0000050000000000050004em;">&#x2211;</span><span class="msupsub"><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mbin">+</span><span class="mop"><span class="mop op-symbol small-op" style="top:-0.0000050000000000050004em;">&#x2211;</span><span class="msupsub"><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord textstyle uncramped"><span class="mop"><span class="mop op-symbol small-op" style="top:-0.0000050000000000050004em;">&#x2211;</span><span class="msupsub"><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span></p>
<p>&#x6CE8;&#xFF1A;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">w_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#x4E3A;&#x7EC4;&#x5408;&#x7279;&#x5F81;&#x7684;&#x6743;&#x91CD;&#xFF0C;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mrow><mi>i</mi></mrow></msub><mi>x</mi><mrow><mi>j</mi></mrow></mrow><annotation encoding="application/x-tex">x_{i}x{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathit">x</span><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span></span></span>&#x4E3A;&#x4E24;&#x4E24;&#x7279;&#x5F81;&#x7EC4;&#x5408;</p>
<p>&#x7406;&#x89E3;&#xFF1A;</p>
<ul>
<li>1&#x3001;&#x5373;xi,xj(&#x90FD;&#x662F;one-hot&#x7279;&#x5F81;&#xFF09;&#x540C;&#x65F6;&#x4E3A;1&#x65F6;&#x53EF;&#x80FD;&#x662F;&#x4E00;&#x4E2A;&#x5F88;&#x6709;&#x7528;&#x7684;&#x7279;&#x5F81;&#xFF0C;&#x8FD9;&#x79CD;&#x7EC4;&#x5408;&#x7279;&#x5F81;&#x662F;xi&#x548C;xj&#x7684;&#x7EBF;&#x6027;&#x7EC4;&#x5408;&#x6240;&#x65E0;&#x6CD5;&#x8868;&#x793A;&#x7684;&#x3002;&#x8FD9;&#x6837;&#x4E00;&#x6765;&#x4E58;&#x79EF;xi&#xFF0C;xi&#x5C31;&#x6210;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x7279;&#x5F81;&#x3002;&#x4E3A;&#x4E86;&#x4E0D;&#x9519;&#x8FC7;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;&#x8FD9;&#x79CD;&#x53EF;&#x80FD;&#x6709;&#x7528;&#x7684;&#x7EC4;&#x5408;&#x7279;&#x5F81;&#xFF0C;&#x6211;&#x4EEC;&#x7A77;&#x4E3E;&#x6240;&#x6709;&#x7684;i,j&#x7EC4;&#x5408;&#xFF0C;&#x628A;xi&#xFF0C;xj&#x3002;1 &#x2264;i &#x2264;n,i &lt;j &#x2264;n&#x90FD;&#x52A0;&#x5230;&#x7279;&#x5F81;&#x91CC;&#x9762;&#x53BB;&#xFF0C;&#x7ECF;&#x8FC7;&#x5927;&#x91CF;&#x6837;&#x672C;&#x7684;&#x8BAD;&#x7EC3;&#xFF0C;&#x6A21;&#x578B;&#x4F1A;&#x628A;&#x90A3;&#x4E9B;&#x65E0;&#x7528;&#x7684;&#x7279;&#x5F81;&#x7684;&#x7CFB;&#x6570;&#x8BAD;&#x7EC3;&#x4E3A;0&#x3002;</li>
<li><p>2&#x3001;&#x800C;&#x5728;&#x8FD9;&#x91CC;&#x4EA4;&#x53C9;&#x9879;&#x7684;&#x6BCF;&#x4E00;&#x4E2A;&#x53C2;&#x6570;wij&#x7684;&#x5B66;&#x4E60;&#x8FC7;&#x7A0B;&#x9700;&#x8981;&#x5927;&#x91CF;&#x7684;xi&#x3001;xj&#x540C;&#x65F6;&#x975E;&#x96F6;&#x7684;&#x8BAD;&#x7EC3;&#x6837;&#x672C;&#x6570;&#x636E;&#x3002;&#x7531;&#x4E8E;&#x6837;&#x672C;&#x6570;&#x636E;&#x672C;&#x6765;&#x5C31;&#x5F88;&#x7A00;&#x758F;&#xFF0C;&#x80FD;&#x591F;&#x6EE1;&#x8DB3;&#x201C;xi&#x548C;xj&#x90FD;&#x975E;&#x96F6;&#x201D;&#x7684;&#x6837;&#x672C;&#x6570;&#x5C31;&#x4F1A;&#x66F4;&#x5C11;&#x3002;</p>
</li>
<li><p>&#x8BAD;&#x7EC3;&#x53C2;&#x6570;&#xFF1A;&#x7531;&#x4E8E;&#x4E8C;&#x6B21;&#x9879;&#x7CFB;&#x6570;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">w_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#x7684;&#x5F15;&#x5165;&#xFF0C;&#x7531;&#x4E8E;&#x7EC4;&#x5408;&#x7279;&#x5F81;&#x6570;&#x91CF;&#x8FC7;&#x5927;&#xFF0C;&#x5728;&#x6570;&#x636E;&#x7A00;&#x758F;&#x6027;&#x666E;&#x904D;&#x5B58;&#x5728;&#x7684;&#x5B9E;&#x9645;&#x5E94;&#x7528;&#x573A;&#x666F;&#x4E2D;&#xFF0C;&#x4E8C;&#x6B21;&#x9879;&#x53C2;&#x6570;&#x7684;&#x8BAD;&#x7EC3;&#x662F;&#x5F88;&#x56F0;&#x96BE;&#x7684;</p>
</li>
</ul>
<h4 id="fm&#x7684;&#x516C;&#x5F0F;factorization-machine">FM&#x7684;&#x516C;&#x5F0F;(Factorization Machine)</h4>
<p>&#x6709;&#x6CA1;&#x6709;&#x4EC0;&#x4E48;&#x529E;&#x6CD5;&#x53EF;&#x4EE5;&#x51CF;&#x5C11;&#x53C2;&#x6570;&#xFF1F;&#x77E9;&#x9635;&#x5206;&#x89E3;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x79CD;&#x89E3;&#x51B3;&#x601D;&#x8DEF;&#xFF01;&#xFF01;</p>
<p>&#x518D;&#x6765;&#x89C2;&#x5BDF;&#x4E8C;&#x6B21;&#x9879;&#x7CFB;&#x6570;&#x77E9;&#x9635;w_{ij}&#xFF0C;&#x5B83;&#x5E94;&#x8BE5;&#x662F;NXN&#x5927;&#x5C0F;&#x7684;&#x77E9;&#x9635;&#x3002;&#x540C;&#x65F6;&#x5B83;&#x662F;&#x7A00;&#x758F;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x7EDD;&#x5927;&#x90E8;&#x5206;&#x7684;&#x7EC4;&#x5408;&#x7279;&#x5F81;&#x90FD;&#x662F;&#x65E0;&#x7528;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x5176;&#x7CFB;&#x6570;&#x5E94;&#x8BE5;&#x4E3A;0&#x3002;</p>
<ul>
<li>&#x89E3;&#x51B3;&#x65B9;&#x6848;&#xFF1A;&#x53EF;&#x4EE5;&#x5BF9;W_{n&#xD7;n}&#x8FDB;&#x884C;&#x77E9;&#x9635;&#x5206;&#x89E3;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>W</mi><mrow><mi>n</mi><mo>&#xD7;</mo><mi>n</mi></mrow></msub><mo>=</mo><msub><mi>V</mi><mrow><mi>n</mi><mo>&#xD7;</mo><mi>k</mi></mrow></msub><msubsup><mi>V</mi><mrow><mi>n</mi><mo>&#xD7;</mo><mi>k</mi></mrow><mi>T</mi></msubsup></mrow><annotation encoding="application/x-tex">W_{n\times n}=V_{n\times k}V_{n\times k}^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:1.1827699999999999em;vertical-align:-0.34143899999999994em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">n</span><span class="mbin mtight">&#xD7;</span><span class="mord mathit mtight">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.22222em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">n</span><span class="mbin mtight">&#xD7;</span><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-left:-0.22222em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">n</span><span class="mbin mtight">&#xD7;</span><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#xFF0C;&#x5373;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo>=</mo><mo>&lt;</mo><msub><mi>v</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>v</mi><mi>j</mi></msub><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">w_{i,j}=&lt;v_i,v_j&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.5391em;"></span><span class="strut bottom" style="height:0.8252079999999999em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mrel">&lt;</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&gt;</span></span></span></span>&#x3002;&#x5176;&#x4E2D;k&#x226A;n&#xFF0C;&#x672C;&#x6765;&#x9700;&#x8981;&#x8BAD;&#x7EC3;&#x7684;n&#xD7;n&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x73B0;&#x5728;&#x53EA;&#x9700;&#x8981;&#x8BAD;&#x7EC3;n&#xD7;k&#x4E2A;&#x3002;</li>
</ul>
<p><img src="../images/FM&#x5206;&#x89E3;.png" alt=""></p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>V</mi><mrow><mi>n</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">V_{nk}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.22222em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">n</span><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#x5305;&#x542B;k&#x4E2A;&#x63CF;&#x8FF0;&#x7279;&#x5F81;&#x7684;&#x56E0;&#x5B50;&#x3002;</li>
</ul>
<p><img src="../images/FM&#x5206;&#x89E3;2.png" alt=""></p>
<h3 id="583-&#x5728;&#x7EBF;&#x4F18;&#x5316;&#x7B97;&#x6CD5;onlinelearning">5.8.3 &#x5728;&#x7EBF;&#x4F18;&#x5316;&#x7B97;&#x6CD5;-Online-learning</h3>
<blockquote>
<p>In computer science, online machine learning is a method of machine learning in which data becomes available in a sequential order and is used to update our best predictor for future data at each step, as opposed to batch learning techniques which generate the best predictor by learning on the entire training data set at once.</p>
</blockquote>
<p>&#x5728;&#x5DE5;&#x4E1A;&#x754C;&#xFF0C;&#x4E0D;&#x5355;&#x53C2;&#x4E0E;&#x8BAD;&#x7EC3;&#x7684;&#x6570;&#x636E;&#x91CF;&#x5927;&#xFF0C;&#x6A21;&#x578B;&#x7279;&#x5F81;&#x91CF;&#x7684;&#x89C4;&#x6A21;&#x4E5F;&#x5927;&#x3002;&#x6BD4;&#x5982;&#x70B9;&#x51FB;&#x7387;&#x9884;&#x4F30;&#xFF0C;&#x5F80;&#x5F80;&#x7279;&#x5F81;&#x89C4;&#x6A21;&#x4F1A;&#x5728;&#x4EBF;&#x7EA7;&#x522B;&#xFF0C;&#x8BAD;&#x7EC3;&#x6570;&#x636E;&#x5F88;&#x5BB9;&#x6613;&#x8FC7;TB&#xFF0C;&#x5BF9;&#x8D44;&#x6E90;&#x7684;&#x538B;&#x529B;&#x5F88;&#x5927;&#x3002;&#x6700;&#x4F18;&#x5316;&#x6C42;&#x89E3;&#x95EE;&#x9898;&#x53EF;&#x80FD;&#x662F;&#x6211;&#x4EEC;&#x5728;&#x5DE5;&#x4F5C;&#x4E2D;&#x9047;&#x5230;&#x7684;&#x6700;&#x591A;&#x7684;&#x4E00;&#x7C7B;&#x95EE;&#x9898;&#x4E86;&#xFF1A;&#x4ECE;&#x5DF2;&#x6709;&#x7684;&#x6570;&#x636E;&#x4E2D;&#x63D0;&#x70BC;&#x51FA;&#x6700;&#x9002;&#x5408;&#x7684;&#x6A21;&#x578B;&#x53C2;&#x6570;&#xFF0C;&#x4ECE;&#x800C;&#x5BF9;&#x672A;&#x77E5;&#x7684;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x9884;&#x6D4B;&#x3002;&#x5F53;&#x6211;&#x4EEC;&#x9762;&#x5BF9;&#x9AD8;&#x7EF4;&#x9AD8;&#x6570;&#x636E;&#x91CF;&#x7684;&#x573A;&#x666F;&#x65F6;&#xFF0C;&#x5E38;&#x89C1;&#x7684;&#x6279;&#x91CF;&#x5904;&#x7406;&#x7684;&#x65B9;&#x5F0F;&#x5DF2;&#x7ECF;&#x663E;&#x5F97;&#x529B;&#x4E0D;&#x4ECE;&#x5FC3;&#xFF0C;&#x9700;&#x8981;&#x6709;&#x5728;&#x7EBF;&#x5904;&#x7406;&#x7684;&#x65B9;&#x6CD5;&#x6765;&#x89E3;&#x51B3;&#x6B64;&#x7C7B;&#x95EE;&#x9898;&#x3002;</p>
<p>&#x51C6;&#x786E;&#x5730;&#x8BF4;&#xFF0C;Online Learning&#x5E76;&#x4E0D;&#x662F;&#x4E00;&#x79CD;&#x6A21;&#x578B;&#xFF0C;&#x800C;&#x662F;&#x4E00;&#x79CD;&#x6A21;&#x578B;&#x7684;&#x8BAD;&#x7EC3;&#x65B9;&#x6CD5;&#xFF0C;Online Learning&#x80FD;&#x591F;&#x6839;&#x636E;&#x7EBF;&#x4E0A;&#x53CD;&#x9988;&#x6570;&#x636E;&#xFF0C;&#x5B9E;&#x65F6;&#x5FEB;&#x901F;&#x5730;&#x8FDB;&#x884C;&#x6A21;&#x578B;&#x8C03;&#x6574;&#xFF0C;&#x4F7F;&#x5F97;&#x6A21;&#x578B;&#x53CA;&#x65F6;&#x53CD;&#x6620;&#x7EBF;&#x4E0A;&#x7684;&#x53D8;&#x5316;&#xFF0C;&#x63D0;&#x9AD8;&#x7EBF;&#x4E0A;&#x9884;&#x6D4B;&#x7684;&#x51C6;&#x786E;&#x7387;&#x3002;Online Learning&#x7684;&#x6D41;&#x7A0B;&#x5305;&#x62EC;&#xFF1A;&#x5C06;&#x6A21;&#x578B;&#x7684;&#x9884;&#x6D4B;&#x7ED3;&#x679C;&#x5C55;&#x73B0;&#x7ED9;&#x7528;&#x6237;&#xFF0C;&#x7136;&#x540E;&#x6536;&#x96C6;&#x7528;&#x6237;&#x7684;&#x53CD;&#x9988;&#x6570;&#x636E;&#xFF0C;&#x518D;&#x7528;&#x6765;&#x8BAD;&#x7EC3;&#x6A21;&#x578B;&#xFF0C;&#x5F62;&#x6210;&#x95ED;&#x73AF;&#x7684;&#x7CFB;&#x7EDF;&#x3002;&#x5982;&#x4E0B;&#x56FE;&#x6240;&#x793A;&#xFF1A;</p>
<p>&#x6BD4;&#x8F83;&#x51FA;&#x540D;&#x7684;&#x5728;&#x7EBF;&#x6700;&#x4F18;&#x5316;&#x7684;&#x65B9;&#x6CD5;&#x6709;&#xFF1A;</p>
<ul>
<li>TG(Truncated Gradient)</li>
<li>FOBOS(Forward-Backward Splitting)</li>
<li>RDA(Regularized Dual Averaging)</li>
<li><strong>FTRL(Follow the Regularized Leader)</strong></li>
</ul>
<p>SGD&#x7B97;&#x6CD5;&#x662F;&#x5E38;&#x7528;&#x7684;online learning&#x7B97;&#x6CD5;&#xFF0C;&#x5B83;&#x80FD;&#x5B66;&#x4E60;&#x51FA;&#x4E0D;&#x9519;&#x7684;&#x6A21;&#x578B;&#xFF0C;&#x4F46;&#x5B66;&#x51FA;&#x7684;&#x6A21;&#x578B;&#x4E0D;&#x662F;&#x7A00;&#x758F;&#x7684;&#x3002;&#x4E3A;&#x6B64;&#xFF0C;&#x5B66;&#x672F;&#x754C;&#x548C;&#x5DE5;&#x4E1A;&#x754C;&#x90FD;&#x5728;&#x7814;&#x7A76;&#x8FD9;&#x6837;&#x4E00;&#x79CD;online learning&#x7B97;&#x6CD5;&#xFF0C;&#x5B83;&#x80FD;&#x5B66;&#x4E60;&#x51FA;&#x6709;&#x6548;&#x7684;&#x4E14;&#x7A00;&#x758F;&#x7684;&#x6A21;&#x578B;</p>
<h3 id="584-follow-the-regularized-leaderftrl">5.8.4 Follow The Regularized Leader(FTRL)</h3>
<ul>
<li>&#x4E00;&#x79CD;&#x83B7;&#x5F97;&#x7A00;&#x758F;&#x6A21;&#x578B;&#x5E76;&#x4E14;&#x9632;&#x6B62;&#x8FC7;&#x62DF;&#x5408;&#x7684;&#x4F18;&#x5316;&#x65B9;&#x6CD5;</li>
</ul>
<p><img src="../images/FTRL&#x5171;&#x8BC6;.png" alt=""></p>
<h3 id="&#x6B63;&#x5219;&#x5316;regularization">&#x6B63;&#x5219;&#x5316;(Regularization)</h3>
<p><strong>&#x6B63;&#x5219;&#x5316;</strong>&#xFF0C;<strong>&#x5373;&#x5728;&#x6210;&#x672C;&#x51FD;&#x6570;&#x4E2D;&#x52A0;&#x5165;&#x4E00;&#x4E2A;&#x6B63;&#x5219;&#x5316;&#x9879;(&#x60E9;&#x7F5A;&#x9879;)&#xFF0C;&#x60E9;&#x7F5A;&#x6A21;&#x578B;&#x7684;&#x590D;&#x6742;&#x5EA6;&#xFF0C;&#x9632;&#x6B62;&#x7F51;&#x7EDC;&#x8FC7;&#x62DF;&#x5408;</strong></p>
<h4 id="l1&#x4E0E;l2&#x6B63;&#x5219;&#x5316;">L1&#x4E0E;L2&#x6B63;&#x5219;&#x5316;</h4>
<p>&#x903B;&#x8F91;&#x56DE;&#x5F52;&#x7684;&#x53C2;&#x6570;W&#x6570;&#x91CF;&#x6839;&#x636E;&#x7279;&#x5F81;&#x7684;&#x6570;&#x91CF;&#x800C;&#x5B9A;&#xFF0C;&#x90A3;&#x4E48;&#x6B63;&#x5219;&#x5316;&#x5982;&#x4E0B;</p>
<ul>
<li>&#x903B;&#x8F91;&#x56DE;&#x5F52;&#x7684;&#x635F;&#x5931;&#x51FD;&#x6570;&#x4E2D;&#x589E;&#x52A0;L2&#x6B63;&#x5219;&#x5316;</li>
</ul>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>J</mi><mo>(</mo><mi>w</mi><mo separator="true">,</mo><mi>b</mi><mo>)</mo><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mi>m</mi></mrow></mfrac><msubsup><mo>&#x2211;</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><mi>L</mi><mo>(</mo><msup><mover accent="true"><mrow><mi>y</mi></mrow><mo>^</mo></mover><mrow><mo>(</mo><mi>i</mi><mo>)</mo></mrow></msup><mo separator="true">,</mo><msup><mi>y</mi><mrow><mo>(</mo><mi>i</mi><mo>)</mo></mrow></msup><mo>)</mo><mo>+</mo><mfrac><mrow><mi>&#x3BB;</mi></mrow><mrow><mn>2</mn><mi>m</mi></mrow></mfrac><msubsup><mrow><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi><mi>w</mi><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">J(w,b) = \frac{1}{m}\sum_{i=1}^mL(\hat{y}^{(i)},y^{(i)})+\frac{\lambda}{2m}{||w||}^2_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8879999999999999em;"></span><span class="strut bottom" style="height:1.2329999999999999em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mord mathit">b</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">m</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mop"><span class="mop op-symbol small-op" style="top:-0.0000050000000000050004em;">&#x2211;</span><span class="msupsub"><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight">m</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord textstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">y</span></span></span><span style="top:0em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mbin">+</span><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span><span class="mord mathit mtight">m</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">&#x3BB;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x2223;</span><span class="mord mathrm">&#x2223;</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mord mathrm">&#x2223;</span><span class="mord mathrm">&#x2223;</span></span><span class="msupsub"><span class="vlist"><span style="top:0.3em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span style="top:-0.36399999999999993em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></p>
<p>&#x5176;&#x4E2D;&#x7684;L2&#x8303;&#x6570;&#x53EF;&#x4EE5;&#x7406;&#x89E3;&#xFF1A;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi>&#x3BB;</mi></mrow><mrow><mn>2</mn><mi>m</mi></mrow></mfrac><msubsup><mrow><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi><mi>w</mi><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi></mrow><mn>2</mn><mn>2</mn></msubsup><mo>=</mo><mfrac><mrow><mi>&#x3BB;</mi></mrow><mrow><mn>2</mn><mi>m</mi></mrow></mfrac><msubsup><mo>&#x2211;</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><msub><mi>n</mi><mi>x</mi></msub></mrow></msubsup><msubsup><mi>w</mi><mi>j</mi><mn>2</mn></msubsup><mo>=</mo><mfrac><mrow><mi>&#x3BB;</mi></mrow><mrow><mn>2</mn><mi>m</mi></mrow></mfrac><msup><mi>w</mi><mi>T</mi></msup><mi>w</mi></mrow><annotation encoding="application/x-tex">\frac{\lambda}{2m}{||w||}^2_2=\frac{\lambda}{2m}\sum_{j=1}^{n_x}w^2_j = \frac{\lambda}{2m}w^Tw</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8801079999999999em;"></span><span class="strut bottom" style="height:1.2930799999999998em;vertical-align:-0.412972em;"></span><span class="base textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span><span class="mord mathit mtight">m</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">&#x3BB;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x2223;</span><span class="mord mathrm">&#x2223;</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mord mathrm">&#x2223;</span><span class="mord mathrm">&#x2223;</span></span><span class="msupsub"><span class="vlist"><span style="top:0.3em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span style="top:-0.36399999999999993em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span><span class="mord mathit mtight">m</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">&#x3BB;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mop"><span class="mop op-symbol small-op" style="top:-0.0000050000000000050004em;">&#x2211;</span><span class="msupsub"><span class="vlist"><span style="top:0.276864em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.44489999999999996em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight">x</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.258664em;margin-left:-0.02691em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span><span class="mord mathit mtight">m</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">&#x3BB;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span></span></p>
<p>&#x89E3;&#x91CA;&#xFF1A;&#x6240;&#x6709;w&#x53C2;&#x6570;&#x7684;&#x5E73;&#x65B9;&#x548C;&#x7684;&#x7ED3;&#x679C;</p>
<ul>
<li>&#x903B;&#x8F91;&#x56DE;&#x5F52;&#x7684;&#x635F;&#x5931;&#x51FD;&#x6570;&#x4E2D;&#x589E;&#x52A0;L1&#x6B63;&#x5219;&#x5316;</li>
</ul>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>J</mi><mo>(</mo><mi>w</mi><mo separator="true">,</mo><mi>b</mi><mo>)</mo><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mi>m</mi></mrow></mfrac><msubsup><mo>&#x2211;</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><mi>L</mi><mo>(</mo><msup><mover accent="true"><mrow><mi>y</mi></mrow><mo>^</mo></mover><mrow><mo>(</mo><mi>i</mi><mo>)</mo></mrow></msup><mo separator="true">,</mo><msup><mi>y</mi><mrow><mo>(</mo><mi>i</mi><mo>)</mo></mrow></msup><mo>)</mo><mo>+</mo><mfrac><mrow><mi>&#x3BB;</mi></mrow><mrow><mn>2</mn><mi>m</mi></mrow></mfrac><msub><mrow><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi><mi>w</mi><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi></mrow><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">J(w,b) = \frac{1}{m}\sum_{i=1}^mL(\hat{y}^{(i)},y^{(i)}) + \frac{\lambda}{2m}{||w||}_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8879999999999999em;"></span><span class="strut bottom" style="height:1.2329999999999999em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mord mathit">b</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">m</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mop"><span class="mop op-symbol small-op" style="top:-0.0000050000000000050004em;">&#x2211;</span><span class="msupsub"><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight">m</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord textstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">y</span></span></span><span style="top:0em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mbin">+</span><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span><span class="mord mathit mtight">m</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">&#x3BB;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x2223;</span><span class="mord mathrm">&#x2223;</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mord mathrm">&#x2223;</span><span class="mord mathrm">&#x2223;</span></span><span class="msupsub"><span class="vlist"><span style="top:0.3em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></p>
<p>&#x5176;&#x4E2D;L2&#x8303;&#x6570;&#x53EF;&#x4EE5;&#x7406;&#x89E3;&#x4E3A;&#xFF1A;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi>&#x3BB;</mi></mrow><mrow><mn>2</mn><mi>m</mi></mrow></mfrac><msub><mrow><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi><mi>w</mi><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi></mrow><mn>1</mn></msub><mo>=</mo><mfrac><mrow><mi>&#x3BB;</mi></mrow><mrow><mn>2</mn><mi>m</mi></mrow></mfrac><msubsup><mo>&#x2211;</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><msub><mi>n</mi><mi>x</mi></msub></mrow></msubsup><mrow><mi mathvariant="normal">&#x2223;</mi><msub><mi>w</mi><mi>j</mi></msub><mi mathvariant="normal">&#x2223;</mi></mrow></mrow><annotation encoding="application/x-tex">\frac{\lambda}{2m}{||w||}_1 = \frac{\lambda}{2m}\sum_{j=1}^{n_x}{|w_j|}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8801079999999999em;"></span><span class="strut bottom" style="height:1.2930799999999998em;vertical-align:-0.412972em;"></span><span class="base textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span><span class="mord mathit mtight">m</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">&#x3BB;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x2223;</span><span class="mord mathrm">&#x2223;</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mord mathrm">&#x2223;</span><span class="mord mathrm">&#x2223;</span></span><span class="msupsub"><span class="vlist"><span style="top:0.3em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span><span class="mord mathit mtight">m</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">&#x3BB;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mop"><span class="mop op-symbol small-op" style="top:-0.0000050000000000050004em;">&#x2211;</span><span class="msupsub"><span class="vlist"><span style="top:0.276864em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.44489999999999996em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight">x</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord textstyle uncramped"><span class="mord mathrm">&#x2223;</span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm">&#x2223;</span></span></span></span></span></p>
<p>&#x6CE8;&#xFF1A;&#x5176;&#x4E2D;&#xFF0C;&#x3BB; &#x4E3A;&#x6B63;&#x5219;&#x5316;&#x56E0;&#x5B50;&#xFF0C;&#x662F;<strong>&#x8D85;&#x53C2;&#x6570;</strong>&#x3002;&#x7531;&#x4E8E; L1 &#x6B63;&#x5219;&#x5316;&#x6700;&#x540E;&#x5F97;&#x5230; w &#x5411;&#x91CF;&#x4E2D;&#x5C06;&#x5B58;&#x5728;&#x5927;&#x91CF;&#x7684; 0&#xFF0C;&#x4F7F;&#x6A21;&#x578B;&#x53D8;&#x5F97;&#x7A00;&#x758F;&#x5316;&#xFF0C;&#x56E0;&#x6B64; L2 &#x6B63;&#x5219;&#x5316;&#x66F4;&#x52A0;&#x5E38;&#x7528;&#x3002;</p>
<h4 id="&#x6B63;&#x5219;&#x5316;&#x9879;&#x7684;&#x7406;&#x89E3;">&#x6B63;&#x5219;&#x5316;&#x9879;&#x7684;&#x7406;&#x89E3;</h4>
<p>&#x5728;&#x635F;&#x5931;&#x51FD;&#x6570;&#x4E2D;&#x589E;&#x52A0;&#x4E00;&#x9879;&#xFF0C;&#x90A3;&#x4E48;&#x5176;&#x5B9E;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;&#x662F;&#x8981;&#x51CF;&#x5C11;&#x635F;&#x5931;&#x51FD;&#x6570;&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x5BF9;&#x4E8E;L2&#x6216;&#x8005;L1&#x6765;&#x8BB2;&#x90FD;&#x662F;&#x8981;&#x53BB;&#x51CF;&#x5C11;&#x8FD9;&#x4E2A;&#x6B63;&#x5219;&#x9879;&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x90A3;&#x4E48;&#x4E5F;&#x5C31;&#x662F;&#x4F1A;&#x51CF;&#x5C11;W&#x6743;&#x91CD;&#x7684;&#x5927;&#x5C0F;&#x3002;&#x8FD9;&#x662F;&#x6211;&#x4EEC;&#x4E00;&#x4E2A;&#x76F4;&#x89C2;&#x4E0A;&#x7684;&#x611F;&#x53D7;&#x3002;</p>
<ul>
<li>&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x901A;&#x8FC7;&#x65B9;&#x5411;&#x4F20;&#x64AD;&#x6765;&#x7406;&#x89E3;&#x8FD9;&#x4E2A;&#x5176;&#x4E2D;&#x7684;L2&#xFF0C;&#x5BF9;&#x4E8E;&#x635F;&#x5931;&#x51FD;&#x6570;&#x6211;&#x4EEC;&#x8981;&#x53CD;&#x5411;&#x4F20;&#x64AD;&#x6C42;&#x53C2;&#x6570;&#x68AF;&#x5EA6;&#xFF1A;</li>
</ul>
<p>(1) <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>W</mi><mo>=</mo><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mi>w</mi></mrow></mfrac><mo>+</mo><mfrac><mrow><mi>&#x3BB;</mi></mrow><mrow><mi>m</mi></mrow></mfrac><mrow><mi>W</mi></mrow></mrow><annotation encoding="application/x-tex">dW = \frac{\partial L}{\partial w}+ \frac{\lambda}{m} {W}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8801079999999999em;"></span><span class="strut bottom" style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord mathit">d</span><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="mrel">=</span><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathit mtight" style="margin-right:0.02691em;">w</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathit mtight">L</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mbin">+</span><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">m</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">&#x3BB;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">W</span></span></span></span></span></p>
<p>&#x524D;&#x9762;&#x7684;&#x9ED8;&#x8BA4;&#x635F;&#x5931;&#x51FD;&#x6570;&#x7684;&#x68AF;&#x5EA6;&#x8BA1;&#x7B97;&#x7ED3;&#x679C;&#x9ED8;&#x8BA4;&#x4E3A;backprop&#xFF0C;&#x90A3;&#x4E48;&#x66F4;&#x65B0;&#x7684;&#x53C2;&#x6570;&#x5C31;&#x4E3A;</p>
<p>(2) <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>W</mi><mo>:</mo><mo>=</mo><mi>W</mi><mo>&#x2212;</mo><mi>&#x3B1;</mi><mi>d</mi><mi>W</mi></mrow><annotation encoding="application/x-tex">W := W - \alpha dW</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="mrel">:</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="mbin">&#x2212;</span><span class="mord mathit" style="margin-right:0.0037em;">&#x3B1;</span><span class="mord mathit">d</span><span class="mord mathit" style="margin-right:0.13889em;">W</span></span></span></span>
&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x5C06;&#x7B2C;&#x4E00;&#x4E2A;&#x516C;&#x5F0F;&#x5E26;&#x5165;&#x7B2C;&#x4E8C;&#x4E2A;&#x5F97;&#x5230;</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>&#x2212;</mo><mo>&#x2212;</mo><mo>&gt;</mo><mi>W</mi><mo>:</mo><mo>=</mo><mi>W</mi><mo>&#x2212;</mo><mi>&#x3B1;</mi><mo>(</mo><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mi>w</mi></mrow></mfrac><mo>+</mo><mfrac><mrow><mi>&#x3BB;</mi></mrow><mrow><mi>m</mi></mrow></mfrac><mi>W</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">--&gt;W := W - \alpha(\frac{\partial L}{\partial w} + \frac{\lambda}{m}W)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8801079999999999em;"></span><span class="strut bottom" style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord">&#x2212;</span><span class="mord">&#x2212;</span><span class="mrel">&gt;</span><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="mrel">:</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="mbin">&#x2212;</span><span class="mord mathit" style="margin-right:0.0037em;">&#x3B1;</span><span class="mopen">(</span><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathit mtight" style="margin-right:0.02691em;">w</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathit mtight">L</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mbin">+</span><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">m</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">&#x3BB;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="mclose">)</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>&#x2212;</mo><mo>&#x2212;</mo><mo>&gt;</mo><mo>=</mo><mi>W</mi><mo>&#x2212;</mo><mfrac><mrow><mi>&#x3B1;</mi><mi>&#x3BB;</mi></mrow><mrow><mi>m</mi></mrow></mfrac><mi>W</mi><mo>&#x2212;</mo><mi>&#x3B1;</mi><mo>&#x2217;</mo><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mi>w</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">--&gt;=W - \frac{\alpha \lambda}{m}W - \alpha*\frac{\partial L}{\partial w}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8801079999999999em;"></span><span class="strut bottom" style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord">&#x2212;</span><span class="mord">&#x2212;</span><span class="mrel">&gt;</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="mbin">&#x2212;</span><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">m</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.0037em;">&#x3B1;</span><span class="mord mathit mtight">&#x3BB;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="mbin">&#x2212;</span><span class="mord mathit" style="margin-right:0.0037em;">&#x3B1;</span><span class="mbin">&#x2217;</span><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathit mtight" style="margin-right:0.02691em;">w</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathit mtight">L</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></p>
<p>&#x6240;&#x4EE5;&#x6BCF;&#x6B21;&#x66F4;&#x65B0;&#x7684;&#x65F6;&#x5019;&#x90FD;&#x4F1A;&#x8BA9;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>W</mi><mo>(</mo><mn>1</mn><mo>&#x2212;</mo><mfrac><mrow><mi>&#x3B1;</mi><mi>&#x3BB;</mi></mrow><mrow><mi>m</mi></mrow></mfrac><mo>)</mo></mrow><annotation encoding="application/x-tex">W(1 - \frac{\alpha \lambda}{m})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8801079999999999em;"></span><span class="strut bottom" style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mbin">&#x2212;</span><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">m</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.0037em;">&#x3B1;</span><span class="mord mathit mtight">&#x3BB;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose">)</span></span></span></span>,&#x8FD9;&#x4E2A;&#x7CFB;&#x6570;&#x6C38;&#x8FDC;&#x5C0F;&#x4E8E;1&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x901A;&#x5E38;&#x79F0;L2&#x8303;&#x6570;&#x4E3A;<strong>&#x6743;&#x91CD;&#x8870;&#x51CF;</strong>&#x3002;</p>
<p>FTRL&#x7B97;&#x6CD5;&#x7684;&#x8BBE;&#x8BA1;&#x601D;&#x60F3;&#x5176;&#x5B9E;&#x5E76;&#x4E0D;&#x590D;&#x6742;&#xFF0C;&#x5C31;&#x662F;<strong>&#x6BCF;&#x6B21;&#x627E;&#x5230;&#x8BA9;&#x4E4B;&#x524D;&#x6240;&#x6709;&#x76EE;&#x6807;&#x51FD;&#x6570;&#xFF08;&#x635F;&#x5931;&#x51FD;&#x6570;&#x52A0;&#x6B63;&#x5219;&#x9879;&#xFF09;&#x4E4B;&#x548C;&#x6700;&#x5C0F;&#x7684;&#x53C2;&#x6570;</strong>&#x3002;&#x8BE5;&#x7B97;&#x6CD5;&#x5728;&#x5904;&#x7406;&#x8BF8;&#x5982;&#x903B;&#x8F91;&#x56DE;&#x5F52;&#x4E4B;&#x7C7B;&#x7684;&#x5E26;&#x975E;&#x5149;&#x6ED1;&#x6B63;&#x5219;&#x5316;&#x9879;&#xFF08;&#x5982;L1&#x6B63;&#x5219;&#x9879;&#xFF09;&#x7684;&#x51F8;&#x4F18;&#x5316;&#x95EE;&#x9898;&#x4E0A;&#x8868;&#x73B0;&#x51FA;&#x8272;&#xFF0C;&#x5728;&#x8BA1;&#x7B97;&#x7CBE;&#x5EA6;&#x548C;&#x7279;&#x5F81;&#x7684;&#x7A00;&#x758F;&#x6027;&#x4E0A;&#x505A;&#x5230;&#x4E86;&#x5F88;&#x597D;&#x7684;trade-off&#xFF0C;&#x800C;&#x4E14;&#x5728;&#x5DE5;&#x7A0B;&#x5B9E;&#x73B0;&#x4E0A;&#x505A;&#x4E86;&#x5927;&#x91CF;&#x4F18;&#x5316;&#xFF0C;&#x6027;&#x80FD;&#x4F18;&#x5F02;&#x3002;</p>
<ul>
<li><strong>&#x6B63;&#x5219;&#x9879;</strong>&#xFF1A;&#x4F17;&#x6240;&#x5468;&#x77E5;&#xFF0C;<strong>&#x76EE;&#x6807;&#x51FD;&#x6570;&#x6DFB;&#x52A0;L1&#x6B63;&#x5219;&#x9879;&#x53EF;&#x589E;&#x52A0;&#x6A21;&#x578B;&#x89E3;&#x7684;&#x7A00;&#x758F;&#x6027;&#xFF0C;&#x6DFB;&#x52A0;L2&#x6B63;&#x5219;&#x9879;&#x6709;&#x5229;&#x4E8E;&#x9632;&#x6B62;&#x6A21;&#x578B;&#x8FC7;&#x62DF;&#x5408;</strong>&#x3002;&#x4E5F;&#x53EF;&#x4EE5;&#x5C06;&#x4E24;&#x8005;&#x7ED3;&#x5408;&#x4F7F;&#x7528;&#xFF0C;&#x5373;&#x6DF7;&#x5408;&#x6B63;&#x5219;&#xFF0C;FTRL&#x5C31;&#x662F;&#x8FD9;&#x6837;&#x8BBE;&#x8BA1;&#x7684;&#x3002;<ul>
<li><strong>&#x7A00;&#x758F;&#x6027;</strong>&#xFF1A;&#x6A21;&#x578B;&#x89E3;&#x7684;&#x7A00;&#x758F;&#x6027;&#x5728;&#x673A;&#x5668;&#x5B66;&#x4E60;&#x4E2D;&#x662F;&#x5F88;&#x91CD;&#x8981;&#x7684;&#xFF0C;&#x5C24;&#x5176;&#x662F;&#x5728;&#x5DE5;&#x7A0B;&#x5E94;&#x7528;&#x9886;&#x57DF;&#x3002;&#x7A00;&#x758F;&#x7684;&#x6A21;&#x578B;&#x89E3;&#x4F1A;&#x5927;&#x5927;&#x51CF;&#x5C11;&#x9884;&#x6D4B;&#x65F6;&#x7684;&#x5185;&#x5B58;&#x548C;&#x65F6;&#x95F4;&#x590D;&#x6742;&#x5EA6;&#x3002;&#x5E38;&#x7528;&#x7684;&#x7A00;&#x758F;&#x6027;&#x65B9;&#x6CD5;&#x5305;&#x62EC;&#xFF1A;</li>
</ul>
</li>
</ul>
<h3 id="583-&#x6848;&#x4F8B;&#xFF1A;&#x7F8E;&#x56FD;&#x666E;&#x67E5;&#x6570;&#x636E;ftrl&#x4F7F;&#x7528;&#x6548;&#x679C;&#x5BF9;&#x6BD4;">5.8.3 &#x6848;&#x4F8B;&#xFF1A;&#x7F8E;&#x56FD;&#x666E;&#x67E5;&#x6570;&#x636E;-FTRL&#x4F7F;&#x7528;&#x6548;&#x679C;&#x5BF9;&#x6BD4;</h3>
<h4 id="tensorflow-ftrl-&#x8BFB;&#x53D6;&#x8BAD;&#x7EC3;">TensorFlow FTRL &#x8BFB;&#x53D6;&#x8BAD;&#x7EC3;</h4>
<ul>
<li>&#x7B97;&#x6CD5;&#x53C2;&#x6570;<ul>
<li>lambda1&#xFF1A;L1&#x6B63;&#x5219;&#x7CFB;&#x6570;&#xFF0C;&#x53C2;&#x8003;&#x503C;&#xFF1A;10 ~ 15</li>
<li>lambda2&#xFF1A;L2&#x6B63;&#x5219;&#x7CFB;&#x6570;&#xFF0C;&#x53C2;&#x8003;&#x503C;&#xFF1A;10 ~ 15</li>
<li>alpha&#xFF1A;FTRL&#x53C2;&#x6570;&#xFF0C;&#x53C2;&#x8003;&#x503C;&#xFF1A;0.1</li>
<li>beta&#xFF1A;FTRL&#x53C2;&#x6570;&#xFF0C;&#x53C2;&#x8003;&#x503C;&#xFF1A;1.0</li>
<li>batchSize: mini-batch&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x53C2;&#x8003;&#x503C;&#xFF1A;10000</li>
</ul>
</li>
<li><p>&#x6027;&#x80FD;&#x8BC4;&#x6D4B;</p>
<ul>
<li>&#x8BBE;&#x7F6E;&#x53C2;&#x6570;&#xFF1A;<ul>
<li>lambda1 = 15&#xFF0C;lambda2 = 15&#xFF0C; alpha = 0.1&#xFF0C; beta = 1.0</li>
</ul>
</li>
</ul>
</li>
<li><p>&#x4F7F;&#x7528;FTRL&#x7B97;&#x6CD5;&#x8BAD;&#x7EC3;&#x6A21;&#x578B;</p>
</li>
</ul>
<pre><code class="lang-python">classifiry = tf.estimator.LinearClassifier(feature_columns=feature_cl,
                                               optimizer=tf.train.FtrlOptimizer(
                                                   learning_rate=<span class="hljs-number">0.01</span>,
                                                   l1_regularization_strength=<span class="hljs-number">10</span>,
                                                   l2_regularization_strength=<span class="hljs-number">15</span>,
                                               ))
</code></pre>
<p>&#x4F46;&#x662F;&#x4F1A;&#x53D1;&#x73B0;&#xFF0C;&#x52A0;&#x4E0A;&#x6B63;&#x5219;&#x5316;&#x4E4B;&#x540E;&#x6548;&#x679C;&#x5E76;&#x4E0D;&#x4E00;&#x5B9A;&#x5F97;&#x5230;&#x663E;&#x8457;&#x63D0;&#x5347;&#xFF0C;&#x8FD9;&#x4E5F;&#x662F;&#x5728;&#x4E8E;FTRL&#x66F4;&#x9002;&#x5408;&#x5927;&#x91CF;&#x7684;&#x7A00;&#x758F;&#x7279;&#x5F81;&#x548C;&#x5927;&#x91CF;&#x6570;&#x636E;&#x573A;&#x666F;&#x3002;(&#x4E0B;&#x9762;&#x90FD;&#x53EA;&#x662F;&#x5728;epoch=3,batch=32&#x7684;&#x6761;&#x4EF6;&#x4E0B;&#x5F97;&#x51FA;&#x7684;&#xFF0C;&#x53EF;&#x4EE5;&#x8BA9;&#x8BAD;&#x7EC3;&#x4E00;&#x76F4;&#x8FDB;&#x884C;&#xFF0C;&#x5728;Tensorboard&#x4E2D;&#x67E5;&#x770B;&#x6548;&#x679C;)</p>
<table>
<thead>
<tr>
<th>&#x666E;&#x67E5;&#x6570;&#x636E;&#x6A21;&#x578B;</th>
<th>baseline</th>
<th>Feature intersection</th>
<th>FTRL</th>
</tr>
</thead>
<tbody>
<tr>
<td>accuracy</td>
<td>0.8323813</td>
<td>0.8401818</td>
<td>0.9046435</td>
</tr>
<tr>
<td>auc</td>
<td>0.87850624</td>
<td>0.89078486</td>
<td>0.5774169</td>
</tr>
</tbody>
</table>
<h3 id="584-&#x9ED1;&#x9A6C;&#x79BB;&#x7EBF;&#x6570;&#x636E;&#x8BAD;&#x7EC3;ftrl&#x6A21;&#x578B;">5.8.4 &#x9ED1;&#x9A6C;&#x79BB;&#x7EBF;&#x6570;&#x636E;&#x8BAD;&#x7EC3;FTRL&#x6A21;&#x578B;</h3>
<ul>
<li>&#x76EE;&#x7684;&#xFF1A;&#x901A;&#x8FC7;&#x79BB;&#x7EBF;TFRecords&#x6837;&#x672C;&#x6570;&#x636E;&#xFF0C;&#x8BAD;&#x7EC3;FTRL&#x6A21;&#x578B;</li>
<li>&#x6B65;&#x9AA4;&#xFF1A;<ul>
<li>1&#x3001;&#x6784;&#x5EFA;TFRecords&#x7684;&#x8F93;&#x5165;&#x6570;&#x636E;</li>
<li>2&#x3001;&#x4F7F;&#x7528;&#x6A21;&#x578B;&#x8FDB;&#x884C;&#x7279;&#x5F81;&#x5217;&#x6307;&#x5B9A;</li>
<li>3&#x3001;&#x6A21;&#x578B;&#x8BAD;&#x7EC3;&#x4EE5;&#x53CA;&#x9884;&#x4F30;</li>
</ul>
</li>
</ul>
<p><strong>1&#x3001;&#x6784;&#x5EFA;TFRecords&#x7684;&#x8F93;&#x5165;&#x6570;&#x636E;</strong></p>
<ul>
<li>feature: 121&#x5217;&#x503C;&#xFF0C;1channel_id, 100 vector, 10user_weights, 10 article_weights<ul>
<li>(1)&#x7ED9;&#x6BCF;&#x4E2A;&#x503C;&#x6307;&#x5B9A;&#x4E00;&#x4E2A;&#x7C7B;&#x578B;</li>
<li>(2)&#x540E;&#x9762;&#x7ED9;&#x4E86;&#x4E09;&#x79CD;&#x8BFB;&#x53D6;&#x5904;&#x7406;&#x65B9;&#x5F0F;&#xFF0C;&#x4EE5;&#x53CA;&#x8BAD;&#x7EC3;&#x65F6;&#x7684;&#x7279;&#x5F81;&#x5F62;&#x72B6;</li>
</ul>
</li>
<li>&#x89E3;&#x6790;example:tf.parse_single_example(example_proto, features)<ul>
<li>features = {
&quot;label&quot;: tf.FixedLenFeature([], tf.int64),
&quot;feature&quot;: tf.FixedLenFeature([], tf.string)
}</li>
<li>&#x9488;&#x5BF9;&#x6BCF;&#x4E00;&#x4E2A;&#x6837;&#x672C;&#x6307;&#x5B9A;&#xFF0C;string&#x7C7B;&#x578B;&#x9700;&#x8981;&#x89E3;&#x6790;</li>
<li>tf.decode_raw(parsed_features[&apos;feature&apos;], tf.float64)</li>
</ul>
</li>
</ul>
<pre><code class="lang-python">FEATURE_COLUMNS = [<span class="hljs-string">&apos;channel_id&apos;</span>, <span class="hljs-string">&apos;vector&apos;</span>, <span class="hljs-string">&apos;user_weights&apos;</span>, <span class="hljs-string">&apos;article_weights&apos;</span>]


<span class="hljs-decorator">@staticmethod</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">read_ctr_records</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-comment"># &#x5B9A;&#x4E49;&#x8F6C;&#x6362;&#x51FD;&#x6570;,&#x8F93;&#x5165;&#x65F6;&#x5E8F;&#x5217;&#x5316;&#x7684;</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">parse_tfrecords_function</span><span class="hljs-params">(example_proto)</span>:</span>
        features = {
            <span class="hljs-string">&quot;label&quot;</span>: tf.FixedLenFeature([], tf.int64),
            <span class="hljs-string">&quot;feature&quot;</span>: tf.FixedLenFeature([], tf.string)
        }
        parsed_features = tf.parse_single_example(example_proto, features)

        feature = tf.decode_raw(parsed_features[<span class="hljs-string">&apos;feature&apos;</span>], tf.float64)
        feature = tf.reshape(tf.cast(feature, tf.float32), [<span class="hljs-number">1</span>, <span class="hljs-number">121</span>])
        <span class="hljs-comment"># &#x7279;&#x5F81;&#x987A;&#x5E8F; 1 channel_id,  100 article_vector, 10 user_weights, 10 article_weights</span>
        <span class="hljs-comment"># 1 channel_id&#x7C7B;&#x522B;&#x578B;&#x7279;&#x5F81;&#xFF0C; 100&#x7EF4;&#x6587;&#x7AE0;&#x5411;&#x91CF;&#x6C42;&#x5E73;&#x5747;&#x503C;&#x5F53;&#x8FDE;&#x7EED;&#x7279;&#x5F81;&#xFF0C;10&#x7EF4;&#x7528;&#x6237;&#x6743;&#x91CD;&#x6C42;&#x5E73;&#x5747;&#x503C;&#x5F53;&#x8FDE;&#x7EED;&#x7279;&#x5F81;</span>
        channel_id = tf.cast(tf.slice(feature, [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>]), tf.int32)
        vector = tf.reduce_sum(tf.slice(feature, [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">100</span>]), axis=<span class="hljs-number">1</span>)
        user_weights = tf.reduce_sum(tf.slice(feature, [<span class="hljs-number">0</span>, <span class="hljs-number">101</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">10</span>]), axis=<span class="hljs-number">1</span>)
        article_weights = tf.reduce_sum(tf.slice(feature, [<span class="hljs-number">0</span>, <span class="hljs-number">111</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">10</span>]), axis=<span class="hljs-number">1</span>)

        label = tf.cast(parsed_features[<span class="hljs-string">&apos;label&apos;</span>], tf.float32)

        <span class="hljs-comment"># &#x6784;&#x9020;&#x5B57;&#x5178; &#x540D;&#x79F0;-tensor</span>
        tensor_list = [channel_id, vector, user_weights, article_weights]

        feature_dict = dict(zip(FEATURE_COLUMNS, tensor_list))

        <span class="hljs-keyword">return</span> feature_dict, label

    dataset = tf.data.TFRecordDataset([<span class="hljs-string">&quot;./train_ctr_20190605.tfrecords&quot;</span>])
    dataset = dataset.map(parse_tfrecords_function)
    dataset = dataset.batch(<span class="hljs-number">64</span>)
    dataset = dataset.repeat(<span class="hljs-number">10</span>)
    <span class="hljs-keyword">return</span> dataset
</code></pre>
<p>2&#x3001;&#x4F7F;&#x7528;&#x6A21;&#x578B;&#x8FDB;&#x884C;&#x7279;&#x5F81;&#x5217;&#x6307;&#x5B9A;</p>
<pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">train_eval</span><span class="hljs-params">(self)</span>:</span>
    <span class="hljs-string">&quot;&quot;&quot;
    &#x8BAD;&#x7EC3;&#x6A21;&#x578B;
    :return:
    &quot;&quot;&quot;</span>
    <span class="hljs-comment"># &#x79BB;&#x6563;&#x5206;&#x7C7B;</span>
    article_id = tf.feature_column.categorical_column_with_identity(<span class="hljs-string">&apos;channel_id&apos;</span>, num_buckets=<span class="hljs-number">25</span>)
    <span class="hljs-comment"># &#x8FDE;&#x7EED;&#x7C7B;&#x578B;</span>
    vector = tf.feature_column.numeric_column(<span class="hljs-string">&apos;vector&apos;</span>)
    user_weigths = tf.feature_column.numeric_column(<span class="hljs-string">&apos;user_weigths&apos;</span>)
    article_weights = tf.feature_column.numeric_column(<span class="hljs-string">&apos;article_weights&apos;</span>)

    feature_columns = [article_id, vector, user_weigths, article_weights]
</code></pre>
<p>3&#x3001;&#x6A21;&#x578B;&#x8BAD;&#x7EC3;&#x4EE5;&#x53CA;&#x9884;&#x4F30;</p>
<pre><code class="lang-python">classifiry = tf.estimator.LinearClassifier(feature_columns=feature_columns,
                                           optimizer=tf.train.FtrlOptimizer(learning_rate=<span class="hljs-number">0.1</span>,
                                                                            l1_regularization_strength=<span class="hljs-number">10</span>,
                                                                            l2_regularization_strength=<span class="hljs-number">10</span>))
classifiry.train(LrWithFtrl.read_ctr_records, steps=<span class="hljs-number">10000</span>)
result = classifiry.evaluate(LrWithFtrl.read_ctr_records)
print(result)
</code></pre>
<p>&#x6700;&#x7EC8;&#x6548;&#x679C;&#x4E0E;&#x4E4B;&#x524D;spark LR&#x6A21;&#x578B;&#x7684;&#x6548;&#x679C;&#x5BF9;&#x6BD4;</p>
<table>
<thead>
<tr>
<th>&#x9ED1;&#x9A6C;&#x6837;&#x672C;&#x6A21;&#x578B;&#x5BF9;&#x6BD4;</th>
<th>baseline</th>
<th>FTRL(3&#x4E2A;epoch)</th>
</tr>
</thead>
<tbody>
<tr>
<td>accuracy</td>
<td>0.9051438053097345</td>
<td>0.9046435</td>
</tr>
<tr>
<td>auc</td>
<td>0.719274521004087</td>
<td>0.585196</td>
</tr>
</tbody>
</table>
<p>&#x5B8C;&#x6574;&#x4EE3;&#x7801;&#xFF1A;</p>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> tensorflow <span class="hljs-keyword">as</span> tf

FEATURE_COLUMNS = [<span class="hljs-string">&apos;channel_id&apos;</span>, <span class="hljs-string">&apos;vector&apos;</span>, <span class="hljs-string">&apos;user_weigths&apos;</span>, <span class="hljs-string">&apos;article_weights&apos;</span>]


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LrWithFtrl</span><span class="hljs-params">(object)</span>:</span>
    <span class="hljs-string">&quot;&quot;&quot;LR&#x4EE5;FTRL&#x65B9;&#x5F0F;&#x4F18;&#x5316;
    &quot;&quot;&quot;</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self)</span>:</span>
        <span class="hljs-keyword">pass</span>

<span class="hljs-decorator">    @staticmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">read_ctr_records</span><span class="hljs-params">()</span>:</span>
        <span class="hljs-comment"># &#x5B9A;&#x4E49;&#x8F6C;&#x6362;&#x51FD;&#x6570;,&#x8F93;&#x5165;&#x65F6;&#x5E8F;&#x5217;&#x5316;&#x7684;</span>
        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">parse_tfrecords_function</span><span class="hljs-params">(example_proto)</span>:</span>
            features = {
                <span class="hljs-string">&quot;label&quot;</span>: tf.FixedLenFeature([], tf.int64),
                <span class="hljs-string">&quot;feature&quot;</span>: tf.FixedLenFeature([], tf.string)
            }
            parsed_features = tf.parse_single_example(example_proto, features)

            feature = tf.decode_raw(parsed_features[<span class="hljs-string">&apos;feature&apos;</span>], tf.float64)
            feature = tf.reshape(tf.cast(feature, tf.float32), [<span class="hljs-number">1</span>, <span class="hljs-number">121</span>])
            channel_id = tf.cast(tf.slice(feature, [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>]), tf.int32)
            vector = tf.slice(feature, [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">100</span>])
            user_weights = tf.slice(feature, [<span class="hljs-number">0</span>, <span class="hljs-number">101</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">10</span>])
            article_weights = tf.slice(feature, [<span class="hljs-number">0</span>, <span class="hljs-number">111</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">10</span>])

            label = tf.cast(parsed_features[<span class="hljs-string">&apos;label&apos;</span>], tf.float32)

            <span class="hljs-comment"># &#x6784;&#x9020;&#x5B57;&#x5178; &#x540D;&#x79F0;-tensor</span>
            FEATURE_COLUMNS = [<span class="hljs-string">&apos;channel_id&apos;</span>, <span class="hljs-string">&apos;vector&apos;</span>, <span class="hljs-string">&apos;user_weights&apos;</span>, <span class="hljs-string">&apos;article_weights&apos;</span>]

            tensor_list = [channel_id, vector, user_weights, article_weights]

            feature_dict = dict(zip(FEATURE_COLUMNS, tensor_list))

            <span class="hljs-keyword">return</span> feature_dict, label

        dataset = tf.data.TFRecordDataset([<span class="hljs-string">&quot;./ctr_train_20190706.tfrecords&quot;</span>])
        dataset = dataset.map(parse_tfrecords_function)
        dataset = dataset.batch(<span class="hljs-number">64</span>)
        dataset = dataset.repeat()
        <span class="hljs-keyword">return</span> dataset

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">train_eval</span><span class="hljs-params">(self)</span>:</span>
        <span class="hljs-string">&quot;&quot;&quot;
        &#x8BAD;&#x7EC3;&#x6A21;&#x578B;
        :return:
        &quot;&quot;&quot;</span>
        <span class="hljs-comment"># &#x79BB;&#x6563;&#x5206;&#x7C7B;</span>
        article_id = tf.feature_column.categorical_column_with_identity(<span class="hljs-string">&apos;channel_id&apos;</span>, num_buckets=<span class="hljs-number">25</span>)
        <span class="hljs-comment"># &#x8FDE;&#x7EED;&#x7C7B;&#x578B;</span>
        vector = tf.feature_column.numeric_column(<span class="hljs-string">&apos;vector&apos;</span>, shape=[<span class="hljs-number">1</span>, <span class="hljs-number">100</span>])
        user_weigths = tf.feature_column.numeric_column(<span class="hljs-string">&apos;user_weigths&apos;</span>, shape=[<span class="hljs-number">1</span>, <span class="hljs-number">10</span>])
        article_weights = tf.feature_column.numeric_column(<span class="hljs-string">&apos;article_weights&apos;</span>, shape=[<span class="hljs-number">1</span>, <span class="hljs-number">10</span>])

        feature_columns = [article_id, vector, user_weigths, article_weights]

        classifiry = tf.estimator.LinearClassifier(feature_columns=feature_columns,
                                                   optimizer=tf.train.FtrlOptimizer(learning_rate=<span class="hljs-number">0.1</span>,
                                                                                    l1_regularization_strength=<span class="hljs-number">10</span>,
                                                                                    l2_regularization_strength=<span class="hljs-number">10</span>))
        classifiry.train(LrWithFtrl.read_ctr_records)
        result = classifiry.evaluate(LrWithFtrl.read_ctr_records)
        print(result)


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&apos;__main__&apos;</span>:
    lwf = LrWithFtrl()
    lwf.train_eval()
</code></pre>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../day08/section3.html" class="navigation navigation-prev " aria-label="Previous page: 分桶与特征交叉"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../day08/section5.html" class="navigation navigation-next " aria-label="Next page: 深度学习CTR排序模型"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="../gitbook/plugins/gitbook-plugin-expandable-chapters-small/expandable-chapters-small.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-livereload/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"katex":{},"expandable-chapters-small":{},"highlight":{},"search":{"maxIndexSize":1000000},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"livereload":{}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
